/*!
 * jKern.js
 * Version: 0.1
 * Inspired by Joshua Gross (http://kerningjs.com)
 * Copyright 2011 Olivier Gorzalka
 * MIT license
 */
(function($){
/*!
     * jQuery based CSS parser
     * documentation: http://youngisrael-stl.org/wordpress/2009/01/16/jquery-css-parser/
     * Version: 1.3
     * Copyright (c) 2011 Daniel Wachsstock
     * MIT license
     */
(function(){$.fn.findandfilter=function(selector){var ret=this.filter(selector).add(this.find(selector));ret.prevObject=ret.prevObject.prevObject;return ret};$.fn.parsecss=function(callback,parseAttributes){var parse=function(str){$.parsecss(str,callback)};this.findandfilter("style").each(function(){parse(this.innerHTML)}).end().findandfilter('link[type="text/css"],link[rel="stylesheet"]').each(function(){if(!this.disabled&&!($(this).attr("href").indexOf("//"+window.location.host)<0&&/^\w+:/.test($(this).attr("href")))&&$.parsecss.mediumApplies(this.media)){$.get(this.href,parse)}}).end();if(parseAttributes){$.get(location.pathname+location.search,"text",function(HTMLtext){styleAttributes(HTMLtext,callback)})}return this};$.parsecss=function(str,callback){var ret={};str=munge(str).replace(/@(([^;`]|`[^b]|`b[^%])*(`b%)?);?/g,function(s,rule){processAtRule($.trim(rule),callback);return""});$.each(str.split("`b%"),function(i,css){css=css.split("%b`");if(css.length<2){return}css[0]=restore(css[0]);ret[css[0]]=$.extend(ret[css[0]]||{},parsedeclarations(css[1]))});callback(ret)};$.parsecss.mediumApplies=(window.media&&window.media.query)||function(str){if(!str){return true}if(str in media){return media[str]}var style=$('<style media="'+str+'">body {position: relative; z-index: 1;}</style>').appendTo("head");return media[str]=[$("body").css("z-index")==1,style.remove()][0]};$.parsecss.isValidSelector=function(str){var s=$("<style>"+str+"{}</style>").appendTo("head")[0];return[s.styleSheet?!/UNKNOWN/i.test(s.styleSheet.cssText):!!s.sheet.cssRules.length,$(s).remove()][0]};$.parsecss.parseArguments=function(str){if(!str){return[]}var ret=[],mungedArguments=munge(str,true).split(/\s+/);for(var i=0;i<mungedArguments.length;++i){var a=restore(mungedArguments[i]);try{ret.push(eval("("+a+")"))}catch(err){ret.push(a)}}return ret};$.parsecss.styleAttributes=styleAttributes;var media={};var munged={};function parsedeclarations(index){var str=munged[index].replace(/^{|}$/g,"");str=munge(str);var parsed={};$.each(str.split(";"),function(i,decl){decl=decl.split(":");if(decl.length<2){return}parsed[restore(decl[0])]=restore(decl.slice(1).join(":"))});return parsed}var REbraces=/{[^{}]*}/;var REfull=/\[[^\[\]]*\]|{[^{}]*}|\([^()]*\)|function(\s+\w+)?(\s*%b`\d+`b%){2}/;var REatcomment=/\/\*@((?:[^\*]|\*[^\/])*)\*\//g;var REcomment_string=/(?:\/\*(?:[^\*]|\*[^\/])*\*\/)|(\\.|"(?:[^\\\"]|\\.|\\\n)*"|'(?:[^\\\']|\\.|\\\n)*')/g;var REmunged=/%\w`(\d+)`\w%/;var uid=0;function munge(str,full){str=str.replace(REatcomment,"$1").replace(REcomment_string,function(s,string){if(!string){return""}var replacement="%s`"+(++uid)+"`s%";munged[uid]=string.replace(/^\\/,"");return replacement});var RE=full?REfull:REbraces;while(match=RE.exec(str)){replacement="%b`"+(++uid)+"`b%";munged[uid]=match[0];str=str.replace(RE,replacement)}return str}function restore(str){if(str===undefined){return str}while(match=REmunged.exec(str)){str=str.replace(REmunged,munged[match[1]])}return $.trim(str)}function processAtRule(rule,callback){var split=rule.split(/\s+/);var type=split.shift();if(type=="media"){var css=restore(split.pop()).slice(1,-1);if($.parsecss.mediumApplies(split.join(" "))){$.parsecss(css,callback)}}else{if(type=="import"){var url=restore(split.shift());if($.parsecss.mediumApplies(split.join(" "))){url=url.replace(/^url\(|\)$/gi,"").replace(/^["']|["']$/g,"");$.get(url,function(str){$.parsecss(str,callback)})}}}}var _show={show:$.fn.show,hide:$.fn.hide};$.each(["show","hide"],function(){var which=this,show=_show[which],plugin=which+"Default";$.fn[which]=function(){if(arguments.length>0){return show.apply(this,arguments)}return this.each(function(){var fn=$.data(this,plugin),$this=$(this);if(fn){$.removeData(this,plugin);fn.call($this);$this.queue(function(){$this.data(plugin,fn).dequeue()})}else{show.call($this)}})};$.fn[plugin]=function(){var args=$.makeArray(arguments),name=args[0];if($.fn[name]){args.shift();var fn=$.fn[name]}else{if($.effects&&$.effects[name]){if(typeof args[1]!="object"){args.splice(1,0,{})}fn=_show[which]}else{fn=_show[which]}}return this.data(plugin,function(){fn.apply(this,args)})}});var RESGMLcomment=/<!--([^-]|-[^-])*-->/g;var REnotATag=/(>)[^<]*/g;var REtag=/<(\w+)([^>]*)>/g;function styleAttributes(HTMLtext,callback){var ret="",style,tags={};HTMLtext=HTMLtext.replace(RESGMLcomment,"").replace(REnotATag,"$1");munge(HTMLtext).replace(REtag,function(s,tag,attrs){tag=tag.toLowerCase();if(tags[tag]){++tags[tag]}else{tags[tag]=1}if(style=/\bstyle\s*=\s*(%s`\d+`s%)/i.exec(attrs)){var id=/\bid\s*=\s*(\S+)/i.exec(attrs);if(id){id="#"+restore(id[1]).replace(/^['"]|['"]$/g,"")}else{id=tag+":eq("+(tags[tag]-1)+")"}ret+=[id,"{",restore(style[1]).replace(/^['"]|['"]$/g,""),"}"].join("")}});$.parsecss(ret,callback)}})();(function(){function injector(t,splitter,klass,after){var a=t.text().split(splitter),inject="";if(a.length){$(a).each(function(i,item){inject+='<span class="'+klass+(i+1)+'">'+item+"</span>"+after});t.empty().append(inject)}}var methods={init:function(){return this.each(function(){injector($(this),"","char","")})},words:function(){return this.each(function(){injector($(this)," ","word"," ")})},lines:function(){return this.each(function(){var r="eefec303079ad17405c889e092e105b0";injector($(this).children("br").replaceWith(r).end(),r,"line","")})}};$.fn.lettering=function(method){if(method&&methods[method]){return methods[method].apply(this,[].slice.call(arguments,1))}else{if(method==="letters"||!method){return methods.init.apply(this,[].slice.call(arguments,0))}}$.error("Method "+method+" does not exist on jQuery.lettering");return this}})();window.jKern=new (function(){var self=this;this._parse=function(css,ignoreParsed){if(!self._parsedCSS){self._parsedCSS=css}for(var selector in css){if(match=selector.match(new RegExp("(.*):((first|last)-)?(letter|word)(:nth-(child|last-child|of-type|last-of-type)(.*)|:last-of-type|:first-of-type|:first-child|:last-child)?"),"ig")){var $elements=$(match[1]),type=(match[4]=="letter")?"char":"word",exprFilter=(typeof match[3]!="undefined"&&match[3]!="")?":"+match[3]:match[5];$elements.not(".kerningjs").addClass("kerningjs").css("visibility","inherit").lettering("words").children("span").css("display","inline-block").lettering().children("span").css("display","inline-block");$elements.find("span[class^="+type+"]"+exprFilter).css(css[selector])}}};this.live=function(){$(document).bind("DOMNodeInserted",function(evt){if(evt.target){self.refresh(true)}})};this.refresh=function(newElementsOnly){if(self._parsedCSS){self._parse(self._parsedCSS,newElementsOnly)}};$(function(){$(document).parsecss(self._parse,true)})})()})(jQuery);