(function(a){function b(b,c,d,e){var f=b.text().split(c),g="";if(f.length){a(f).each(function(a,b){g+='<span class="'+d+(a+1)+'">'+b+"</span>"+e});b.empty().append(g)}}var d={init:function(){return this.each(function(){b(a(this),"","char","")})},words:function(){return this.each(function(){b(a(this)," ","word"," ")})},lines:function(){return this.each(function(){var c="eefec303079ad17405c889e092e105b0";b(a(this).children("br").replaceWith(c).end(),c,"line","")})}};a.fn.lettering=function(b){if(b&&d[b]){return d[b].apply(this,[].slice.call(arguments,1))}else if(b==="letters"||!b){return d.init.apply(this,[].slice.call(arguments,0))}a.error("Method "+b+" does not exist on jQuery.lettering");return this};a.jkerny={loadExternalStyles:true,exclude:[],lettering_replace:{":letter":"span.letter",":word":"span.word",":first-word":"span.word:first-child",":last-word":"span.word:last-child",":first-letter":"span.word:first-child span.letter:first-child",":last-letter":"span.word:last-child span.letter:last-child"},only_selectors:[/span\.(word|letter)/],only_properties:[/-jkerny-(word|letter)-spacing/],pseudo_selectors:/:(hover|active|focus|visited)/,disableCaching:false,checkMediaTypes:true,cache:{},loadQueue:[],completeQueue:[],media:{},testDiv:null,run:function(b){var c=[];var d=this;a("style:not([rel=jkerny]),link[rel=stylesheet]").each(function(){if(d.checkMediaTypes){if(!d.mediumApplies(this.media))return}if(this.href){if(d.loadExternalStyles){d.loadQueue.push(this.href);d.loadStylesFrom(this.href)}}else{b=d.convertPseudoSelectors(this.innerHTML);c=c.concat(d.parse(b));d.proceedLettering(c)}});if(b){c.concat(this.parse(b))}c=this.filterSelectors(c)},ignoreMediaQueries:function(a){return a.replace(new RegExp("@media[^{]+{([^{}]+{[^}{]+})+","gi"),"")},convertPseudoSelectors:function(a){var b=this;for(var c in b.lettering_replace){a=a.replace(new RegExp(c,"g")," "+b.lettering_replace[c])}return a},loadStylesFrom:function(b){var c=this;a.ajax({url:b,success:function(a){content=c.convertPseudoSelectors(a);content=c.ignoreMediaQueries(content);c.refreshLoadQueue(b,content)}})},refreshLoadQueue:function(a,b){if(this.loadQueue.length==0)return;if(a){if(a==this.loadQueue[0]){this.loadQueue.shift();this.runStylesFromText(b);this.refreshLoadQueue()}else{this.completeQueue.push({href:a,txt:b});this.refreshLoadQueue()}}else{if(this.completeQueue.length>0){for(i in this.completeQueue){var c=this.completeQueue[i];if(c.href==this.loadQueue[0]){this.loadQueue.shift();this.completeQueue.splice(i,1);this.runStylesFromText(c.txt);this.refreshLoadQueue()}}}}},runStylesFromText:function(a){var b=this,c=this.filterSelectors(this.parse(a));b.proceedLettering(c)},rawCss:function(a,b){var c=a+" { ";for(attribute in b){c+=attribute+":"+b[attribute]+"; "}c+="} ";return c},applyCss:function(b,c){if(b.indexOf(":hover")>-1){var d=b.split(":hover"),e=a(d[0]);e.on("mouseenter",function(){$styledElements=a.trim(d[1])!=""?a(this).find(a.trim(d[1])):a(this);$styledElements.data({"default-style":$styledElements.attr("style")}).css(c)});e.on("mouseleave",function(){$styledElements=a.trim(d[1])!=""?a(this).find(a.trim(d[1])):a(this);$styledElements.attr("style",$styledElements.data("default-style"))})}else{a(b).css(c)}},proceedLettering:function(b){var c=this,d="";a.each(b,function(){var b=this,e=a(b.selector.replace(this.pseudo_selectors,"").split(/ span.(letter|word)/g)[0]);e.not(".jkerny").addClass("jkerny").css("visibility","inherit").lettering("words").children("span").css("display","inline-block").addClass("word").lettering().children("span").css("display","inline-block").addClass("letter");if(typeof b.attributes["-jkerny-letter-spacing"]!="undefined"){var f=b.attributes["-jkerny-letter-spacing"].replace(/[\n\s]+/g," ").split(" ");for(var g=0;g<=f.length;g++){c.applyCss(b.selector+" span.word span:eq("+g+")",{marginRight:f[g]})}}if(typeof b.attributes["-jkerny-word-spacing"]!="undefined"){var f=b.attributes["-jkerny-word-spacing"].replace(/[\n\s]+/g," ").split(" ");for(var g=1;g<=f.length;g++){c.applyCss(b.selector+" span.word"+g,{marginRight:f[g-1]})}}a.each(c.only_selectors,function(){if(b.selector.match(this)){d+=c.rawCss(b.selector,b.attributes)}})});a('<style rel="jkerny">'+d+"</style>").appendTo("body")},scanCache:function(a){for(var b in this.cache){if(a.search(new RegExp("^"+b+"[ >]"))>-1)return[this.cache[b],a.replace(new RegExp("^"+b+"[ >]"),"")]}},filterSelectors:function(a){if(!a.length)return[];var b=a;if(this.only_selectors&&this.only_selectors.length||this.only_properties&&this.only_properties.length){var c=this.only_selectors,d=this.only_properties,e=[],f=[];for(var g=0;g<c.length;g++){for(var h=0;h<b.length;h++){if(typeof c[g]=="string"?b[h].selector==c[g]:b[h].selector.match(c[g])){e.push(b[h]);f.push(b[h].selector)}}}for(var g=0;g<d.length;g++){for(var h=0;h<b.length;h++){for(attribute in b[h].attributes){if(typeof d[g]=="string"?attribute.selector==d[g]:attribute.match(d[g])&&jQuery.inArray(b[h].selector,f)<0){e.push(b[h]);continue}}}}b=e}if(this.exclude&&this.exclude.length){var i=this.exclude;for(var g=0;g<i.length;g++){for(var h=0;h<b.length;h++){if(typeof i[g]=="string"?b[h].selector==i[g]:b[h].selector.match(i[g])){b.splice(h,1);h--}}}}return b},mediumApplies:function(b){if(!b)return true;if(b in this.media)return this.media[b];if(!this.testDiv){this.testDiv=a('<div id="mediaTestDiv" style="position:relative">').append("<div>").appendTo("body")}var c=a('<style type="text/css" media="'+b+'" />').appendTo("head")[0];try{c.appendChild(document.createTextNode(""))}catch(d){}if(c.styleSheet){c.styleSheet.addRule("#mediaTestDiv","left: 1px")}else if(c.sheet){c.sheet.insertRule("#mediaTestDiv {left: 1px}",0)}this.media[b]=this.testDiv.css("left")=="1px";a(c).remove();return this.media[b]},sanitize:function(a){if(!a)return"";var b=a.replace(/[\n\r]/gi,"");b=b.replace(/\/\*.+?\*\//gi,"");b=b.replace(/\} *\r*\t*\}/,"}");return b},parse:function(a){var b=this.sanitize(a),c=[];b=b.match(/.+?\{.+?\}/gi);if(!b)return[];for(var d=0;d<b.length;d++)if(b[d])c.push({selector:this.parseSelectorName(b[d]),attributes:this.parseAttributes(b[d])});return c},parseSelectorName:function(b){return a.trim(b.match(/^.+?\{/)[0].replace("{",""))},parseAttributes:function(b){var d={};c=b.match(/\{.+?\}/)[0].replace(/[\{\}]/g,"").split(";").slice(0,-1);for(var e=0;e<c.length;e++){if(c[e]){c[e]=c[e].split(":");d[a.trim(c[e][0])]=a.trim(c[e][1])}}return d}}})(jQuery);$(document).ready(function(){$.jkerny.run()})